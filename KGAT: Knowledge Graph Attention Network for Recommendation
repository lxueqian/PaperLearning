KDD 2019
摘要
	在对用户物品交互建模时结合附加信息是有必要的，因子分解机认为这是一个有监督学习问题，假设每个交互都是独立的，但是忽视了例子之间的关系
	本文中，我们用知识图来把独立的交互通过他们的属性联系起来，认为在这样一个知识图和用户物品图的融合结构中，高阶关系——用一个或者多个属性把两个物品连接起来——是成功推荐的必要因素
	提出了一种知识图注意力网络（KGAT）显式地对知识图中的高阶关系建模，能递归地从节点的邻居（可以是用户、物品或者属性）的嵌入向量修正该节点的嵌入向量，并且使用注意力机制来区分邻居节点的不同重要性
	我们提出的KGAT 比之前基于知识库的推荐方法都好，它或者通过提取路径利用高阶关系，或者通过正则化隐式的对高阶关系建模
	KGAT比Neural FM和RippleNet 都好，进一步的研究也证实了高阶关系建模的潜入传播和注意力机制带来的可解释性
	
背景
	几乎每个给用户提供内容的服务都会用到推荐系统，为了通过用户行为预测用户偏好，很多研究用来协同过滤的算法，但是协同过滤的算法不能对附加信息建模，比如物品属性、用户画像、背景文字，所以协同过滤在用户和物品交互很少的情境下效果不好。
	为了结合这些附加信息，一种普遍的方法是把他们变成一个特征向量+用户id+物品id，然后输入到一个监督学习模型中来预测得分，这种模型在工业中被广泛使用，一些有代表性的模型包括FM NFM Wide&Deep xDeepFM
	虽然这些方法效果表现很好，一个缺陷就是他们认为交互是独立的，没有考虑它们之间的关系，CF关注和目标用户买过同样物品的类似用户的购买记录；SL方法强调有相似属性的物品，显然这两类信息可以相互补充，还可以构成一个目标用户和物品的高阶关系，但是已有的SL 方法不能考虑high-order connectivity高阶关系（属性层面的联系）
 
	为了解决基于特征的SL模型的局限，一个办法是在构建预测模型时考虑知识图（物品附加信息的图），我们把知识图和用户物品图的融合结构叫做CKG，成功推荐的关键在于充分挖掘CKG（协同知识图）中的高阶联系。难点在于：1）随着阶数升高计算压力增大；2）高阶关系对预测的贡献不同
KG 由实体-关系-实体组成，实体可以是物品、用户或者属性

	之前一些关于CKG做推荐的研究可以大致被分为以下两类：
1）基于路径的；提取出携带高阶信息的路径并将他们输入预测模型中，为了处理两个点之间的大量路径，或是采用路径选择算法选取主要路径，或者定义元路径模型来限制路径，但一个问题是路径的选取对于最终结果有很大影响，这个过程并没有在推荐目标中得到优化，而且定义有效的元路径需要领域知识，这是很需要劳动力的。
2）基于正则化的；设计额外的损失项来捕捉知识图结构，KTUP和CFKG，不是直接把高阶关系放入模型中优化，只是隐式地把他们编码进去，这样不能保证长范围的连结性被捕捉到，高阶建模结果的可解释性也无法保证。
我们的做法
	考虑到以上现有方法的缺陷，我们认为提出一个可以在知识图中有效、显式、端对端的利用高阶信息的模型十分重要
	图神经网络（GNN）有解决这个问题的潜力，但是基于知识图的推荐没有被应用很多，所以，我们提出一种新方法教KGAT，可以解决高阶关系建模中的两个挑战：1）递归地嵌入性传播，即基于一个嵌入的邻居来更新该节点的嵌入表示，递归地执行这种嵌入传播以在线性时间内捕捉高阶连结性； 2）基于注意力机制的聚合，学习在传播中每个邻居的权重，显示高阶关联性的重要性
本文贡献
	强调显式地对协同知识图中的高阶关系建模以提供带有附加信息的更好的推荐的重要性
	开发新方法KGAT，实现了在图神经网络框架下，显示地和端到端的对高阶关系建模
	在三个公开数据集上实验，证实了KGAT的有效性和理解高阶关系重要性的可解释性
提出任务
	用户物品图：{(u,yui,i)|u ∈U,i ∈I)},三元组，用户+物品+是否购买或点击
	知识图：{(h,r,t)|h,t ∈ E,r ∈ R}, 主题-属性-物品三元组，描述头实体h到尾实体t的关系r，此外还建立了一组物品-实体依赖关系，表示物品i属于知识图中的实体e
	协同知识图：把用户行为和物品的知识融合进一个统一的关系图中，用(u,Interact,i)表示每个用户的行为，当用户与该物品有交互，那么他们之间相当于有另一种关系。然后基于物品实体依赖集合，用户物品图可以被无缝衔接到知识图中。（相当于把用户物品的交互关系融入到物品实体关系中，把用户融入到物品实体图的实体中。）
	任务描述：
输入：协同知识图 
输出：一个可以预测某个用户购买某个产品的可能性
	高阶连结性：利用高阶关联性对于实现高质量推荐十分重要。
L阶关联性：
推断用户偏好：协同过滤方法基于用户行为相似性
SL 模型：关注属性关系，假设用户喜欢用具有相似特征的物品（FM NFM），但是把实体当作单独的特征领域的值，没有充分探索领域之间和相关的例子之间的相关性。（因为假设不同特征领域相互独立，但是也许不是独立的，比如一部电影的演员和另一部的导演是同一个人）

方法论
	提出KGAT的主要组成：1）嵌入层，把每个节点编码成一个向量，以保存CKG的结构；2）注意力嵌入传播层，递归地从该节点的邻居更新该节点的潜入表示，使用一个注意力机制来学习每个邻居的权重； 3）预测层，聚合了用户和物品的所有表示然后输出预测结果
	嵌入层：
TransR 把实体和关系表示成向量，给定一个三元组(h,r,t)，输出是一个分数，越小越好，然后目标函数是一个成对排序的损失。
	注意力嵌入传播层：
借助图神经网络的框架，递归地沿着高阶关联性传播嵌入，此外，通过利用图神经网络的思想，设计了注意力权重显示这个关联的重要性。一个单层=信息传播+知识注意力+信息整合，之后把单层推广到多层。

1）信息传播：一个实体可以出现在多个多元组之中，成为连接两个三元组的桥梁然后传播信息。考虑一个实体h，用N表示h为头实体的所有三元组，叫做ego-network。计算这些三元组的线性组合，线性组合的参数控制着有多少的信息可以从头实体传到尾实体
2）知识注意力：线性组合的参数通过关系注意力机制实现。选取tanh，使得注意力得分取决于头实体和尾实体的距离，近的实体间会传递更多信息，求得Π，然后采用softmax来均一化Π。
最后的注意力得分能表明哪个邻居节点应该被给予更多的关注，以便更好的捕捉协同信号。
不同于GCN或者GraphSage中在两个节点之间设置折扣系数的做法，我们的模型不仅利用了图的主要结构，而且揭示了邻居的不同重要性。此外，不同于图注意力网络，我们没有只把节点表示作为输入，而是对头实体和尾实体的关系嵌入向量进行建模，在传播时可以编码更多信息
3）信息聚合：
